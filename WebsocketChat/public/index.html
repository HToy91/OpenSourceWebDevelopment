<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Socket.io Chat</title>

  <script src="/socket.io/socket.io.js"></script>

    <link rel="stylesheet" href="/css/stylesheet.css">
</head>
<body>

<header></header>
<div class="container">

    <h1>Socket.io Chat</h1>

<!--    <h3>Start with "@bot" to talk to chatbot</h3>-->
    <div class="interface">

            <div class="user-list">
                <h3>Active Users</h3>
                <ul id="user-list"></ul>
            </div>
        <div class="chat-interface">


            <div id="chat-area">
                <div id="chat-box"></div>

            </div>

            <div class="input-row">
                <input type="text" id="message-input" placeholder="Start with '@bot' to chat with the chatbot...">
                <button onclick="sendMessage()">Send Message</button>

            </div>
        </div>
    </div>




</div>

    <script>


        const username = prompt("Enter your username:");
        const socket = io();
        socket.emit("set username", username);

        function sendMessage() {
          const input = document.getElementById('message-input');

          if (input.value.trim() !== "") {
              socket.emit("chat message", input.value);
              input.value = "";
          }
        }

        socket.on("chat message", (msg) => {
          const chatBox = document.getElementById("chat-box");
          const chatArea = document.getElementById("chat-area");
          const messageElement = document.createElement("p")

          if (msg.sender === "jarvis") {
              messageElement.classList.add("chatbot-message");
          }
          messageElement.textContent = `${msg.sender}: ${msg.text}`;

          chatBox.appendChild(messageElement);
          chatBox.scrollTop = chatBox.scrollHeight;
          chatArea.scrollTop = chatArea.scrollHeight;
        });

        socket.on("user list", (userlist) => {
            console.log(`Active users: ${userlist}`);

            const userListElement = document.getElementById("user-list");
            userListElement.textContent = ""; // Clear existing list

            userlist.forEach(user => {
                const li = document.createElement("li");
                li.innerHTML = user;
                userListElement.appendChild(li);
            });
        });

        const input = document.getElementById('message-input');
        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>