{{#if user}}
<h1>Managers Portal</h1>
{{else}}
<h1>Employee Directory</h1>
{{/if}}

{{#if error}}
    <p class="error">{{error}}</p>
{{/if}}

{{#if user}}
<section class="card">
    <form action="/employees/" method="POST">
        <label>
            First Name
            <input name="firstName" type="text" value="{{form.firstName}}" required>
        </label>
        <br>
        <label>
            Last Name
            <input name="lastName" type="text" value="{{form.lastName}}" required>
        </label>
        <br>
        <label>
            Department
            <select name="department" required>
                <option value="" disabled {{#unless form.department}}selected{{/unless}}>Select a department</option>
                <option value="HR" {{#ifEquals form.department "HR"}}selected{{/ifEquals}}>HR</option>
                <option value="Marketing" {{#ifEquals form.department "Marketing"}}selected{{/ifEquals}}>Marketing</option>
                <option value="Sales" {{#ifEquals form.department "Sales"}}selected{{/ifEquals}}>Sales</option>
            </select>
        </label>
        <br>
        <label>
            Start Date
            <input name="startDate" type="date" value="{{form.startDate}}" required>
        </label>
        <br>
        <label>
            Job Title
            <input name="jobTitle" type="text" value="{{form.jobTitle}}" required>
        </label>
        <br>
        <label>
            Salary
            <input name="salary" type="number" step="0.01" min="15" value="{{form.salary}}" required>
            <!--use step="0.01" for cents-->
        </label>
        <br>
        <button type="submit" class="create-btn">Create Employee</button>
    </form>
</section>
{{/if}}

<section class="card">
    <h2>List of Employees</h2>

    {{#if employees.length}}
        <table>
            <thead>
                <tr>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Department</th>
                    <th>Start Date</th>
                    <th>Job Title</th>

                    {{#if user}}
                    <th>Salary</th>
                    <th>Actions</th>
                    {{/if}}
                </tr>
            </thead>

            <tbody>
                {{#each employees}}
                    <tr>
                        <td>{{this.firstName}}</td>
                        <td>{{this.lastName}}</td>
                        <td>{{this.department}}</td>
                        <td>{{this.startDate}}</td>
                        <td>{{this.jobTitle}}</td>

                        {{#if ../user}}
                        <td>${{this.salary}}</td>
                        <td>
                            <a href="/employees/{{this._id}}/edit">Edit</a>
                            <form action="/employees/{{this._id}}?_method=DELETE" method="POST">
                                <button type="submit" onclick="return confirm('Are you sure you want to delete this employee')" class="delete-btn">Delete</button>
                            </form>
                        </td>
                        {{/if}}
                    </tr>
                {{/each}}
            </tbody>
        </table>
    {{else}}
        <p>No employees found.</p>
    {{/if}}
</section>